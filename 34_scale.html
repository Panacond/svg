<!DOCTYPE html>
<html>
  <head>
    <title>Пример style.transform = "scale(2)"</title>
    <style>
      #myDiv {
        width: 100px;
        height: 100px;
        background-color: lightblue;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 16px;
        transition: transform 0.3s ease-in-out; /* Добавляем плавную анимацию */
      }
    </style>
  </head>
  <body>
    <div id="myDiv">Исходный размер</div>
    <button onclick="scaleDiv()">Увеличить в 2 раза</button>
    <button onclick="resetScale()">Вернуть исходный размер</button>
    <div class="scale1-1">Исходный размер 1-1</div>
    <div class="scale2-1">Исходный размер 2-1</div>
    <div class="scale1-2">Исходный размер 1-2</div>
    <svg id="draw" width="210mm" height="200mm" viewBox="0 0 210 200">
      <g class="scale2-1" transform="translate(30, 00)">
        <text x="50" y="10" class="text">Деталь П1</text>
        <rect class="line" x="20" y="20" width="50" height="25" />
      </g>
      <g transform="translate(120, 00)">
        <g class="scale1-1">
          <text x="50" y="10" class="text">Деталь П1</text>
          <rect class="line" x="20" y="20" width="50" height="25" />
        </g>
      </g>
      <g id="plan" transform="translate(20, 100)">
      <g class="scale1-2">
          
            <text x="50" y="-10" class="text">Деталь П1</text>
            <rect class="line" x="0" y="0" width="200" height="100" />
        </g>
      </g>

      <g class="scale1-1">
        <g id="plan" transform="translate(20, 180)">
          <text x="35" y="-10" class="text">1-1</text>
          <rect class="line" x="0" y="0" width="70" height="2" />
        </g>
      </g>
    </svg>

    <script>
      const myDiv = document.getElementById("myDiv");

      function scaleDiv() {
        myDiv.style.transform = "scale(2)";
      }

      function resetScale() {
        myDiv.style.transform = "scale(1)"; // Явно устанавливаем масштаб в 1
      }

      function scaleElement(element) {
        let currentElement = element.parentNode;
        const parentClasses = [];
        parentClasses.push(...element.classList);
        const regex = /(scale)(\d+)-(\d+)/;
        const match = parentClasses.join(", ").match(regex);
        let scale;

        if (match) {
          scale = match[3] / match[2];
          console.log("scale:", scale);
        } else {
          console.log("Совпадений не найдено.");
          scale = 1;
        }
        return scale;
      }

      function changeScale() {
        const elements = document.querySelectorAll('svg *[class^="scale"]');
        elements.forEach((element) => {
          const scale = scaleElement(element);
          element.style.transform = `scale(${scale})`;
          const bbox = element.getBBox();
          element.style.transformOrigin = `${bbox.x}px ${bbox.y}px`;
        });
      }

      function listFunction() {
        changeScale();
      }

      document.addEventListener("DOMContentLoaded", listFunction);
    </script>
  </body>
</html>
